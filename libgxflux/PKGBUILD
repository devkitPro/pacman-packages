# Maintainer: TurtleP <jpostelnek@outlook.com>

_libname=libgxflux
pkgname=${_libname}
pkgver=20230423
_snapshot=91430ea
pkgrel=4
pkgdesc="libgxflux"
arch=("any")
url="https://repo.or.cz/libgxflux.git"
license=("GPL2")
options=(staticlibs !strip)
makedepends=("dkp-toolchain-vars")
depends=("libogc")
groups=("wii-dev" "gamecube-dev")
source=("${_libname}-${_snapshot}.tar.gz::${url}/snapshot/${_snapshot}.tar.gz"
        "libgxflux-changes.patch")

prepare() {
  cd "${_libname}-${_snapshot}"

  patch -Np1 -i ${srcdir}/libgxflux-changes.patch
}

package() {
  source "${DEVKITPRO}/ppcvars.sh"

  cd "${_libname}-${_snapshot}"

  make -C src clean
  make -C src install DESTDIR="$pkgdir"
  make -C src clean
  make -C src install GAMECUBE=1 DESTDIR="$pkgdir"
  make -C src clean
}

sha256sums=('07b7453f7c2eb54aa049498245bea2694feb0a7ae6d7eeb94c3e625d927ac885'
            'abef4126333bd8a41404ae82286ca51a44ad0c2b3e27a4f573c804314827a85a')
