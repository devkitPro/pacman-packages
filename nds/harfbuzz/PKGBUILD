pkgname=nds-harfbuzz
pkgver=4.0.1
pkgrel=1
pkgdesc='HarfBuzz is a text shaping library. Using the HarfBuzz library allows programs to convert a sequence of Unicode input into properly formatted and positioned glyph outputâ€”for any writing system and language.'
arch=('any')
url='https://harfbuzz.github.io/'
license=(LGPL)
options=(!strip libtool staticlibs)
source=(
  "https://github.com/harfbuzz/harfbuzz/releases/download/$pkgver/harfbuzz-$pkgver.tar.xz"
  "harfbuzz-${pkgver}.patch"
)

sha256sums=(
  '98f68777272db6cd7a3d5152bac75083cd52a26176d87bc04c8b3929d33bce49'
  'c2326251bff6153d8354b39d946e4176e960f92e9bb9a6e9148a090bc28d5271'
)
makedepends=('nds-pkg-config' 'dkp-toolchain-vars' 'dkp-meson-scripts')
depends=('nds-freetype')

groups=('nds-portlibs')

build() {
  source /opt/devkitpro/ndsvars.sh
  cd harfbuzz-${pkgver}
  patch -Np1 -i ${srcdir}/harfbuzz-${pkgver}.patch

  ${DEVKITPRO}/meson-cross.sh nds ../crossfile.txt build -Db_ndebug=true -Dthreads=disabled -Dtests=disabled
  ninja -C build
}

package() {

  cd harfbuzz-${pkgver}
  DESTDIR="$pkgdir" ninja -C build install

}
